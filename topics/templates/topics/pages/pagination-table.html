{% extends "topics/base.html" %}
{% load static %}
{% block title %}
    ç¿»é¡µè¡¨æ ¼
{% endblock %}
{% block question %}
    <h1>æ‚¨å¥½ğŸ¦†, çˆ¬è™«er~ğŸ‘‹</h1>
    <h3>
        è¿™æ˜¯ä¸€ä¸ªç¿»é¡µçš„ç½‘é¡µï¼Œå¹¶ä¸”æ•°æ®æ ¼å¼æ˜¯è¡¨æ ¼ğŸ«£
    </h3>
    å®ƒä¸ç¿»é¡µé¢˜ç›®æ²¡å¤ªå¤§åŒºåˆ«å¯¹å§ï¼Œåªæ˜¯æ˜¾ç¤ºæˆäº†ä¸€ä¸ªè¡¨æ ¼ã€‚<br>
{% endblock %}
{% block answer %}{% endblock %}
{% block content %}
    <div class="container mt-5">
        <h1 class="mb-4">ç¿»é¡µè¡¨æ ¼</h1>
        <div id="content">
            <!-- åŠ¨æ€å†…å®¹å°†æ’å…¥åˆ°è¿™é‡Œ -->
        </div>
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">
                <li class="page-item">
                    <a class="page-link" href="#" id="prev-page">ä¸Šä¸€é¡µ</a>
                </li>
                <li class="page-item">
                    <span class="page-link" id="current-page">1</span>
                </li>
                <li class="page-item">
                    <a class="page-link" href="#" id="next-page">ä¸‹ä¸€é¡µ</a>
                </li>
            </ul>
        </nav>
    </div>

    <script>
        let currentPage = 1;

        function fetchData(page) {
            $.ajax({
                url: `/api/pagination_table/${page}/`, // API æ¥å£
                type: 'GET',
                success: function (response) {
                    // å‡è®¾ API è¿”å›çš„æ•°æ®æ ¼å¼ä¸ºï¼š{ "data": [{ "name": "å•†å“A", "price": 100, "image": "url", "rating": 4.5, ... }] }
                    const data = response.data;

                    // åˆ›å»ºè¡¨æ ¼å¤´éƒ¨
                    let tableHtml = `
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>å•†å“å</th>
                                <th>å“ç‰Œ</th>
                                <th>ç±»åˆ«</th>
                                <th>ä»·æ ¼</th>
                                <th>è¯„åˆ†</th>
                                <th>è¯„è®ºæ•°</th>
                                <th>åº“å­˜</th>
                                <th>é”€é‡</th>
                                <th>æè¿°</th>
                            </tr>
                        </thead>
                        <tbody>`;

                    // åŠ¨æ€ç”Ÿæˆè¡¨æ ¼è¡Œ
                    data.forEach(item => {
                        tableHtml += `
                        <tr>
                            <td>${item.name}</td>
                            <td>${item.brand}</td>
                            <td>${item.category}</td>
                            <td>${item.price} å…ƒ</td>
                            <td>${item.rating} â˜…</td>
                            <td>${item.reviews} æ¡</td>
                            <td>${item.stock}</td>
                            <td>${item.sales}</td>
                            <td>${item.description}</td>
                        </tr>`;
                    });

                    tableHtml += `</tbody></table>`;

                    // æ›´æ–°å†…å®¹
                    $('#content').html(tableHtml);

                    // æ›´æ–°å½“å‰é¡µç æ˜¾ç¤º
                    $('#current-page').text(page);
                },
                error: function () {
                    $('#content').html('<div class="alert alert-danger" role="alert">å†…å®¹åŠ è½½å¤±è´¥</div>');
                }
            });
        }

        $(document).ready(function () {
            // åˆå§‹åŒ–åŠ è½½ç¬¬ä¸€é¡µå†…å®¹
            fetchData(currentPage);

            // ä¸Šä¸€é¡µæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            $('#prev-page').click(function (e) {
                e.preventDefault();
                if (currentPage > 1) {
                    currentPage--;
                    fetchData(currentPage);
                }
            });

            // ä¸‹ä¸€é¡µæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            $('#next-page').click(function (e) {
                e.preventDefault();
                currentPage++;
                fetchData(currentPage);
            });
        });
    </script>
{% endblock %}
